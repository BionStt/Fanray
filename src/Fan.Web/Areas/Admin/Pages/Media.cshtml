@page
@model Fan.Web.Pages.Admin.MediaModel
@{
    ViewData["Title"] = "Media";
}

<blog-media inline-template>
    <div>
        <div style="visibility:hidden; opacity:0" id="dropzone">
            <span id="droptext">Drop files to upload</span>
        </div>

        <v-toolbar class="elevation-0">
            <v-btn flat @@click="chooseFilesUpload">
                <v-icon color="primary">cloud_upload</v-icon>
                &nbsp;Upload
            </v-btn>
        </v-toolbar>
        <v-divider></v-divider>
        <v-alert :value="errMsg.length" type="error" dismissible>{{ errMsg }}</v-alert>

        <div class="gallery">
            <div v-for="image in images"
                 :key="image.id"
                 @@click="selectImage(image)"
                 class="square"
                 :title="image.title"
                 :style="{ backgroundImage: 'url(' + image.urlSmall + ')' }"></div>
        </div>

        <v-dialog v-if="selectedImage"
                  v-model="dialogVisible"
                  @@keydown.esc="dialogVisible = false"
                  content-class="dialog">

            <v-container fill-height style="padding:0; margin:0">
                <v-layout row wrap>
                    <v-flex xs12 md8 class="img-preview">
                        <v-container fill-height>
                            <v-layout justify-center align-center>
                                <img :src="selectedImage.urlLarge" alt="Alternate Text" />
                            </v-layout>
                        </v-container>
                    </v-flex>
                    <v-flex xs12 md4 class="img-sidebar">
                        <v-text-field label="Title" v-model="selectedImage.title"></v-text-field>
                        <v-textarea label="Caption" v-model="selectedImage.caption"></v-textarea>
                        <v-text-field label="Alt text" v-model="selectedImage.alt"></v-text-field>
                        @*<v-textarea label="Description" v-model="selectedImage.description"></v-textarea>*@
                        <v-text-field label="URL" readonly v-model="selectedImage.urlOriginal"></v-text-field>
                        <ul>
                            <li>
                                <label>File Name</label><span>{{ selectedImage.fileName }}</span>
                            </li>
                            <li>
                                <label>File Type</label><span>{{ selectedImage.fileType }}</span>
                            </li>
                            <li>
                                <label>Dimensions</label><span><abbr title="Width in pixels">{{ selectedImage.width }}</abbr> ✕ <abbr title="Height in pixels">{{ selectedImage.height }}</abbr></span>
                            </li>
                            <li>
                                <label>Upload Date</label><span>{{ selectedImage.uploadDate }}</span>
                            </li>
                            <li>
                                <label>Upload Via</label><span>{{ selectedImage.uploadVia }}</span>
                            </li>
                        </ul>
                    </v-flex>
                </v-layout>
            </v-container>
            <div class="img-btnbar">
                <v-btn color="error" @@click="deleteImage">Delete</v-btn>
                <v-btn color="primary" @@click.stop="dialogVisible=false">Close</v-btn>
                <v-btn color="primary" @@click="updateImage">Update</v-btn>
            </div>

        </v-dialog>

        <v-dialog v-model="progressDialog"
                  persistent
                  width="300">
            <v-card color="primary" dark>
                <v-card-text>
                    Uploading ...
                    <v-progress-linear indeterminate
                                       color="white"
                                       class="mb-0"></v-progress-linear>
                </v-card-text>
            </v-card>
        </v-dialog>
    </div>
</blog-media>

@section ComponentScripts {
    <script>
        let blogMediaMixin = {
            data: function () {
                return {
                    images: @Html.Raw(Model.Data.ImagesJson),
                    count: @Model.ImageCount,
                };
            }
        };
    </script>
    <script src="~/admin/js/blog-media.js" asp-append-version="true"></script>
}