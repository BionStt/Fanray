@page
@model Fan.Web.Pages.Widgets.BlogCategories.EditModel
@{
    ViewData["Title"] = "Edit Blog Categories Widget";
    Layout = "~/Pages/Widgets/_EditLayout.cshtml";
}

<edit-widget inline-template>
    <v-form v-model="valid">
        <v-text-field label="Title" v-model="widget.title" :rules="titleRules"></v-text-field>
        <v-checkbox v-model="widget.showPostCount" label="Show post counts"></v-checkbox>
        <v-btn @@click="save" :disabled="!valid">Save</v-btn>
    </v-form>
</edit-widget>

@section Scripts{
    <script>
        Vue.component('edit-widget', {
            data: () => ({
                widget: @Html.Raw(Model.WidgetJson),
                valid: false,
                titleRules: [
                    v => !!v.trim() || 'Required',
                ],
            }),
            methods: {
                save() {
                    axios.post('/widgets/blogcategories/edit', this.widget, this.$root.headers)
                        .then(() => {
                            this.$root.updateParent({
                                title: this.widget.title,
                                widgetId: this.widget.id,
                                areaId: this.widget.areaId,
                            });
                        })
                        .catch(err => {
                            console.log(err);
                            this.$root.toastError('Save widget failed.');
                        });
                }
            },
        });
    </script>
}