var app=new Vue({el:"#app",data:()=>({id:0,published:!1,isDraft:!1,pubClicked:!1,pubText:"",saveVisible:!1,saveDisabled:!1,saveText:"Save",closing:!0,fieldChanged:!1,drawer:null,panel:[!0,!0,!0],menuDate:!1,date:"",draftDate:"",selectedCatId:1,cats:[],selectedTags:[],tags:[],slug:"",excerpt:"",title:"",mediaDialogVisible:!1,progressVisible:!1,editor:null,content:"",snackbar:{show:!1,text:"",color:""}}),computed:{disablePubButton(){return 0>=this.title.trim().length||this.pubClicked},tok:function(){return document.querySelector("input[name=\"__RequestVerificationToken\"][type=\"hidden\"]").value},headers(){return{headers:{"XSRF-TOKEN":this.tok}}},payload:function(){return{id:this.id,postDate:this.date,categoryId:this.selectedCatId,tags:this.selectedTags,slug:this.slug,excerpt:this.excerpt,title:this.title,body:this.editor.getData()}}},mounted(){this.initEditor()},methods:{initEditor(){this.id=0|window.location.href.substring(window.location.href.lastIndexOf("/")+1);let a=this;axios.get(`/admin/compose?handler=post&postId=${this.id}`).then(b=>{this.date=b.data.post.postDate,this.selectedCatId=b.data.post.categoryId,this.selectedTags=b.data.post.tags,this.slug=b.data.post.slug,this.excerpt=b.data.post.excerpt,this.title=b.data.post.title,this.content=b.data.post.body,this.published=b.data.post.published,this.isDraft=b.data.post.isDraft,this.draftDate=b.data.post.draftDate,this.cats=b.data.allCats,this.tags=b.data.allTags,this.pubText=this.published?"Update":"Publish";let c;ClassicEditor.create(document.querySelector("#editor"),{autosave:{save(){clearTimeout(c),a.published||(a.saveVisible=!0,a.saveDisabled=!1,a.saveText="Save",c=setTimeout(a.saveDraft,5e3))}}}).then(b=>{a.editor=b}).catch(()=>{})})},onFieldsChange(){this.fieldChanged=!0;this.published||(this.saveVisible=!0,this.saveDisabled=!1,this.saveText="Save")},saveDraft(){this.saveVisible=!0,this.saveDisabled=!0,this.saveText="Saving...",axios.post("/admin/compose?handler=save",this.payload,{headers:{"XSRF-TOKEN":this.tok}}).then(a=>{this.id=a.data.id,this.slug=a.data.slug,this.draftDate=a.data.draftDate,this.isDraft=!0,window.location.href.endsWith("/compose")&&history.replaceState({},null,window.location.href+`/${this.id}`)}).catch(()=>{}),this.fieldChanged=!1,this.saveText="Saved"},revert(){this.published=!1,this.pubText=this.published?"Update":"Publish",this.saveDraft()},pub(){this.closing=!1,this.pubClicked=!0,this.pubText=this.published?"Updating...":"Publishing...";const a=this.published?"/admin/compose?handler=update":"/admin/compose?handler=publish";axios.post(a,this.payload,{headers:{"XSRF-TOKEN":this.tok}}).then(a=>{window.location.replace(a.data)}).catch(()=>{})},insertImages(a){let b="";for(var c=0;c<a.length;c++)b+=`<figure class="image"><img src="${a[c].urlMedium}" alt="${a[c].alt}" title="${a[c].title}"><figcaption>${a[c].caption}</figcaption></figure>`;const d=this.editor.data.processor.toView(b),e=this.editor.data.toModel(d);this.editor.model.insertContent(e,this.editor.model.document.selection),this.mediaDialogVisible=!1},titleEnter(){this.title=this.title.replace(/\n/g," ")},toast(a,b="silver"){this.snackbar.show=!0,this.snackbar.text=a,this.snackbar.color=b},toastError(a){this.snackbar.show=!0,this.snackbar.text=a,this.snackbar.color="red"}}});
//# sourceMappingURL=blog-compose.js.map