{"version":3,"sources":["../../../Pages/Admin/client/js/blog-media.js"],"names":["store","Vuex","Store","strict","state","selectedImages","mutations","setSelectedImages","newSelectedImages","addSelectedImage","image","push","removeSelectedImage","idx","splice","actions","selectImage","commit","deselectImage","emptySelectedImages","Vue","component","template","mixins","mediaMixin","props","data","editDialogVisible","progressDialog","pageNumber","selectedImageIdx","errMsg","isEditor","mounted","initWindowDnd","mode","initImages","computed","showMoreVisible","count","images","length","leftArrowVisible","rightArrowVisible","$store","methods","window","addEventListener","document","querySelector","style","visibility","opacity","e","preventDefault","self","dragFilesUpload","dataTransfer","files","formData","FormData","Array","from","keys","map","x","append","sendImages","chooseFilesUpload","input","createElement","setAttribute","click","onchange","i","axios","post","$root","headers","then","resp","unshift","toast","errorMessage","catch","insertImages","get","medias","clickImage","findIndex","img","id","selected","dispatch","leftArrow","rightArrow","showMore","pageSize","url","found","some","editImages","deleteImages","confirm","selectedCount","ids","toastError","updateImage","closeEditDialog","closeMediaDialog"],"mappings":"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","sourcesContent":["ï»¿// media store\r\nlet store = new Vuex.Store({\r\n    strict: true,\r\n    state: {\r\n        selectedImages: [],\r\n    },\r\n    mutations: {\r\n        setSelectedImages (state, newSelectedImages) {\r\n            state.selectedImages = newSelectedImages;\r\n        },\r\n        addSelectedImage(state, image) {\r\n            state.selectedImages.push(image);\r\n        },\r\n        removeSelectedImage(state, idx) {\r\n            state.selectedImages.splice(idx, 1);\r\n        },\r\n    },\r\n    actions: {\r\n        selectImage: function ({ commit }, image) {\r\n            commit('addSelectedImage', image);\r\n        },\r\n        deselectImage: function ({ commit }, idx) {\r\n            commit('removeSelectedImage', idx);\r\n        },\r\n        emptySelectedImages({ commit, state }) {\r\n            commit('setSelectedImages', []);\r\n        },\r\n    },\r\n});\r\n\r\n// media component\r\nVue.component('blog-media', {\r\n    template: '#blog-media-template',\r\n    mixins: [mediaMixin],\r\n    props: ['mode'],\r\n    store, // required when media runs solo\r\n    data: () => ({\r\n        editDialogVisible: false,\r\n        progressDialog: false,\r\n        pageNumber: 1,\r\n        selectedImageIdx: 0,\r\n        errMsg: '',\r\n        isEditor: false,\r\n    }),\r\n    mounted() {\r\n        this.initWindowDnd();\r\n         \r\n        if (this.mode === 'editor') {\r\n            this.isEditor = true;\r\n            console.log(\"media gallery in editor mode, loading images...\");\r\n            this.initImages();\r\n        }\r\n    },\r\n    computed: {\r\n        showMoreVisible: function () {\r\n            return this.count > this.images.length;\r\n        },\r\n        leftArrowVisible: function () {\r\n            return this.selectedImages.length > 1 && this.selectedImageIdx > 0;\r\n        },\r\n        rightArrowVisible () {\r\n            return this.selectedImages.length > 1 && this.selectedImageIdx < this.selectedImages.length-1;\r\n        },\r\n        selectedImages() { // from store\r\n            return this.$store.state.selectedImages;\r\n        },\r\n    },\r\n    methods: {\r\n        /**\r\n         * Initialize window drag drop events.\r\n         */\r\n        initWindowDnd() {\r\n            window.addEventListener(\"dragenter\", function (e) {\r\n                document.querySelector(\"#dropzone\").style.visibility = \"\";\r\n                document.querySelector(\"#dropzone\").style.opacity = 1;\r\n            });\r\n\r\n            window.addEventListener(\"dragleave\", function (e) {\r\n                e.preventDefault();\r\n                document.querySelector(\"#dropzone\").style.visibility = \"hidden\";\r\n                document.querySelector(\"#dropzone\").style.opacity = 0;\r\n            });\r\n\r\n            window.addEventListener(\"dragover\", function (e) {\r\n                e.preventDefault();\r\n                document.querySelector(\"#dropzone\").style.visibility = \"\";\r\n                document.querySelector(\"#dropzone\").style.opacity = 1;\r\n            });\r\n\r\n            let self = this;\r\n            window.addEventListener(\"drop\", function (e) {\r\n                e.preventDefault();\r\n                document.querySelector(\"#dropzone\").style.visibility = \"hidden\";\r\n                document.querySelector(\"#dropzone\").style.opacity = 0;\r\n                self.dragFilesUpload(e.dataTransfer.files);\r\n            });\r\n        },\r\n        /**\r\n         * Drag files to drop over browser to upload.\r\n         * @param {any} files\r\n         */\r\n        dragFilesUpload(files) {\r\n            this.progressDialog = true;\r\n\r\n            const formData = new FormData();\r\n            if (!files.length) return;\r\n            Array.from(Array(files.length).keys())\r\n                 .map(x => {\r\n                     formData.append('images', files[x]);\r\n                 });\r\n\r\n            this.sendImages(formData);\r\n        },\r\n        /**\r\n         * Click Upload button to choose files to upload.\r\n         */\r\n        chooseFilesUpload() {\r\n            const input = document.createElement('input');\r\n            input.setAttribute('type', 'file');\r\n            input.setAttribute('accept', 'image/*');\r\n            input.setAttribute('multiple', null);\r\n            input.click();\r\n            input.onchange = () => {\r\n                this.progressDialog = true;\r\n                const formData = new FormData();\r\n                for (let i = 0; i < input.files.length; i++) {\r\n                    formData.append('images', input.files[i]);\r\n                }\r\n\r\n                this.sendImages(formData);\r\n            };\r\n        },\r\n        /**\r\n         * Send files to server. The API returns ImageData with a list of media just uploaded and errorMessage if\r\n         * there is any media not able to be uploaded.\r\n         * @param {any} formData\r\n         */\r\n        sendImages(formData) {\r\n            axios.post('/admin/media?handler=image', formData, this.$root.headers)\r\n                .then(resp => {\r\n                    if (resp.data.images.length > 0) {\r\n                        for (var i = 0; i < resp.data.images.length; i++) {\r\n                            this.images.unshift(resp.data.images[i]);\r\n                        }\r\n\r\n                        // inc total number of image by the number of added images\r\n                        console.log(this.count);\r\n                        this.count += resp.data.images.length;\r\n                        console.log(this.count);\r\n\r\n                        this.$root.toast('Image uploaded.');\r\n                    }\r\n                    if (resp.data.errorMessage) this.errMsg = resp.data.errorMessage;\r\n                    this.progressDialog = false;\r\n                })\r\n                .catch(err => {\r\n                    this.progressDialog = false;\r\n                    this.$root.toast('Image upload failed.', 'red');\r\n                    console.log(err);\r\n                });\r\n        },\r\n        insertImages() {\r\n            this.$root.insertImages();\r\n        },\r\n        /**\r\n        * Retrieve first page of images in editor mode.\r\n        */\r\n        initImages() {\r\n            let url = `/admin/media?handler=images`;\r\n            axios.get(url).then(resp => {\r\n                this.images = resp.data.medias;\r\n                this.count = resp.data.count;\r\n            }).catch(err => console.log(err));\r\n        },\r\n        /**\r\n         * Clicks on an image to select it.\r\n         * @param {any} image\r\n         */\r\n        clickImage(image) {\r\n            let idx = this.selectedImages.findIndex(img => img.id === image.id);\r\n\r\n            if (idx !== -1) {\r\n                image.selected = false;\r\n                this.$store.dispatch('deselectImage', idx);\r\n            }\r\n            else {\r\n                image.selected = true;\r\n                this.$store.dispatch('selectImage', image);           \r\n            }\r\n        },\r\n        /**\r\n         * When you select and edit multiple images, you can click arrows to traverse among them.\r\n         */\r\n        leftArrow() {\r\n            this.selectedImageIdx--;\r\n            console.log('leftArrow selectedImageIdx: ', this.selectedImageIdx)\r\n        },\r\n        rightArrow() {\r\n            this.selectedImageIdx++;\r\n            console.log('rightArrow selectedImageIdx: ', this.selectedImageIdx)\r\n        },\r\n        /**\r\n         * Clicks show more button to return next page of images.\r\n         */\r\n        showMore() {\r\n            this.pageNumber++; \r\n            // if user deletes an image, this will ensure to re-get current page before moving to next page\r\n            if (this.images.length < this.pageSize) this.pageNumber--; \r\n            let url = `/admin/media?handler=more&pageNumber=${this.pageNumber}`;\r\n            axios.get(url).then(resp => {\r\n                // returned data is the list of images\r\n                for (var i = 0; i < resp.data.length; i++) {\r\n                    // first make sure returned item is not already on the page\r\n                    var found = this.images.some(function (img) {\r\n                        return img.id === resp.data[i].id;\r\n                    });\r\n\r\n                    if (!found) \r\n                        this.images.push(resp.data[i]); // only append to images if not found\r\n                }\r\n            }).catch(err => console.log(err));\r\n        },\r\n        /**\r\n         * When user selects one or more images and clicks on edit button.\r\n         */\r\n        editImages() {\r\n            this.editDialogVisible = true;\r\n        },\r\n        deleteImages() {\r\n            if (confirm('Are you sure you want to delete the image(s)? They will no longer appear anywhere on your website. This cannot be undone!')) {\r\n                console.log('deleting image: ', this.selectedImage);\r\n\r\n                const selectedCount = this.selectedImages.length;\r\n                let ids = [];\r\n                for (var i = 0; i < selectedCount; i++) {\r\n                    ids.push(this.selectedImages[i].id);\r\n                }\r\n                console.log(ids);\r\n\r\n                let url = `/admin/media?handler=delete`;\r\n                axios.post(url, ids, this.$root.headers)\r\n                    .then(resp => {\r\n                        console.log(\"before delete images length: \",this.images.length);\r\n                        // remove selected images from images since they are deleted\r\n                        for (var i = 0; i < selectedCount; i++) {\r\n                            let idx = this.images.findIndex(img => img.id === this.selectedImages[i].id);\r\n                            this.images.splice(idx, 1);\r\n                        }\r\n\r\n                        // set selectedImages to empty\r\n                        this.$store.dispatch('emptySelectedImages'); \r\n\r\n                        // dec total number of images\r\n                        console.log(\"after delete images length: \",this.images.length);\r\n                        console.log(\"total count before delete: \", this.count);\r\n                        this.count -= selectedCount;\r\n                        console.log(\"total count after delete: \", this.count);\r\n\r\n                        this.$root.toast('Image deleted.');\r\n                    })\r\n                    .catch(err => {\r\n                        this.$root.toastError('Image delete failed.');\r\n                        console.log(err);\r\n                    });\r\n            }\r\n        },\r\n        /**\r\n         * Updates an image info, it does not close the dialog.\r\n         */\r\n        updateImage() {\r\n            let url = `/admin/media?handler=update`;\r\n            axios.post(url, this.selectedImages[this.selectedImageIdx], this.$root.headers)\r\n                .then(resp => {\r\n                    this.$root.toast('Image updated.');\r\n                })\r\n                .catch(err => {\r\n                    this.$root.toastError('Image update failed.');\r\n                    console.log(err);\r\n                });\r\n        },\r\n        /**\r\n         * When user closes the edit dialog by hitting esc or close.\r\n         */\r\n        closeEditDialog() {\r\n            this.selectedImageIdx = 0;\r\n            this.editDialogVisible = false;\r\n        },\r\n        closeMediaDialog() {\r\n            this.$root.closeMediaDialog();\r\n        },\r\n    },\r\n});"],"file":"blog-media.js"}